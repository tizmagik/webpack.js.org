(self.webpackChunk=self.webpackChunk||[]).push([[2358],{2358:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return o}}),n(7378);var t=n(5318);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}const p={};function o({components:e,...a}){return(0,t.kt)("wrapper",s({},p,a,{components:e,mdxType:"MDXLayout"}),(0,t.kt)("hr",null),(0,t.kt)("p",null,"title: Configuration Types\nsort: 3\ncontributors:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"sokra"),(0,t.kt)("li",{parentName:"ul"},"skipjack"),(0,t.kt)("li",{parentName:"ul"},"kbariotis"),(0,t.kt)("li",{parentName:"ul"},"simon04"),(0,t.kt)("li",{parentName:"ul"},"fadysamirsadek"),(0,t.kt)("li",{parentName:"ul"},"byzyk"),(0,t.kt)("li",{parentName:"ul"},"EugeneHlushko"),(0,t.kt)("li",{parentName:"ul"},"dhurlburtusa"),(0,t.kt)("li",{parentName:"ul"},"anshumanv"),(0,t.kt)("li",{parentName:"ul"},"thorn0")),(0,t.kt)("hr",null),(0,t.kt)("p",null,"Besides exporting a single configuration object, there are a few more ways that cover other needs as well."),(0,t.kt)("h2",{id:"exporting-a-function"},"Exporting a Function",(0,t.kt)("a",{parentName:"h2",href:"#exporting-a-function","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("p",null,"Eventually you will find the need to disambiguate in your ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack.config.js")," between ",(0,t.kt)("a",{parentName:"p",href:"/guides/development"},"development")," and ",(0,t.kt)("a",{parentName:"p",href:"/guides/production"},"production builds"),". There are multiple ways to do that. One option is to export a function from your webpack configuration instead of exporting an object. The function will be invoked with two arguments:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"An environment as the first parameter. See the ",(0,t.kt)("a",{parentName:"li",href:"/api/cli/#environment-options"},"environment options CLI documentation")," for syntax examples."),(0,t.kt)("li",{parentName:"ul"},"An options map (",(0,t.kt)("inlineCode",{parentName:"li"},"argv"),") as the second parameter. This describes the options passed to webpack, with keys such as ",(0,t.kt)("a",{parentName:"li",href:"/api/cli/#flags"},(0,t.kt)("inlineCode",{parentName:"a"},"output-path"))," and ",(0,t.kt)("a",{parentName:"li",href:"/api/cli/#flags"},(0,t.kt)("inlineCode",{parentName:"a"},"mode")),".")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-diff"},(0,t.kt)("span",{parentName:"code",className:"token deleted-sign deleted"},(0,t.kt)("span",{parentName:"span",className:"token prefix deleted"},"-"),(0,t.kt)("span",{parentName:"span",className:"token line"},"module.exports = {\n")),(0,t.kt)("span",{parentName:"code",className:"token inserted-sign inserted"},(0,t.kt)("span",{parentName:"span",className:"token prefix inserted"},"+"),(0,t.kt)("span",{parentName:"span",className:"token line"},"module.exports = function(env, argv) {\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix inserted"},"+"),(0,t.kt)("span",{parentName:"span",className:"token line"},"  return {\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix inserted"},"+"),(0,t.kt)("span",{parentName:"span",className:"token line"},"    mode: env.production ? 'production' : 'development',\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix inserted"},"+"),(0,t.kt)("span",{parentName:"span",className:"token line"},"    devtool: env.production ? 'source-map' : 'eval',\n")),(0,t.kt)("span",{parentName:"code",className:"token unchanged"},(0,t.kt)("span",{parentName:"span",className:"token prefix unchanged"}," "),(0,t.kt)("span",{parentName:"span",className:"token line"},"    plugins: [\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix unchanged"}," "),(0,t.kt)("span",{parentName:"span",className:"token line"},"      new TerserPlugin({\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix unchanged"}," "),(0,t.kt)("span",{parentName:"span",className:"token line"},"        terserOptions: {\n")),(0,t.kt)("span",{parentName:"code",className:"token inserted-sign inserted"},(0,t.kt)("span",{parentName:"span",className:"token prefix inserted"},"+"),(0,t.kt)("span",{parentName:"span",className:"token line"},"          compress: argv.mode === 'production' // only if `--mode production` was passed\n")),(0,t.kt)("span",{parentName:"code",className:"token unchanged"},(0,t.kt)("span",{parentName:"span",className:"token prefix unchanged"}," "),(0,t.kt)("span",{parentName:"span",className:"token line"},"        }\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix unchanged"}," "),(0,t.kt)("span",{parentName:"span",className:"token line"},"      })\n"),(0,t.kt)("span",{parentName:"span",className:"token prefix unchanged"}," "),(0,t.kt)("span",{parentName:"span",className:"token line"},"    ]\n")),(0,t.kt)("span",{parentName:"code",className:"token inserted-sign inserted"},(0,t.kt)("span",{parentName:"span",className:"token prefix inserted"},"+"),(0,t.kt)("span",{parentName:"span",className:"token line"},"  };\n")),"};")),(0,t.kt)("h2",{id:"exporting-a-promise"},"Exporting a Promise",(0,t.kt)("a",{parentName:"h2",href:"#exporting-a-promise","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("p",null,"webpack will run the function exported by the configuration file and wait for a Promise to be returned. Handy when you need to asynchronously load configuration variables."),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{parentName:"aside",className:"tip__prefix"},"tip"),(0,t.kt)("p",{parentName:"aside"},"It is possible to export multiple promises by wrapping them into ",(0,t.kt)("inlineCode",{parentName:"p"},"Promise.all([/* Your promises */])."))),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-js"},"module",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,t.kt)("span",{parentName:"code",className:"token function-variable function"},"exports")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=>")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"Promise"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token parameter"},"resolve",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},",")," reject"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=>")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token function"},"setTimeout"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=>")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      ",(0,t.kt)("span",{parentName:"code",className:"token function"},"resolve"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        entry",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'./app.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,t.kt)("span",{parentName:"code",className:"token comment"},"/* ... */"),"\n      ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,t.kt)("span",{parentName:"code",className:"token number"},"5000"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\n",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{parentName:"aside",className:"warning__prefix"},"warning"),(0,t.kt)("p",{parentName:"aside"},"Returning a ",(0,t.kt)("inlineCode",{parentName:"p"},"Promise")," only works when using webpack via CLI. ",(0,t.kt)("a",{parentName:"p",href:"/api/node/#webpack"},(0,t.kt)("inlineCode",{parentName:"a"},"webpack()"))," expects an object.")),(0,t.kt)("h2",{id:"exporting-multiple-configurations"},"Exporting multiple configurations",(0,t.kt)("a",{parentName:"h2",href:"#exporting-multiple-configurations","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("p",null,"Instead of exporting a single configuration object/function, you may export multiple configurations (multiple functions are supported since webpack 3.1.0). When running webpack, all configurations are built. For instance, this is useful for ",(0,t.kt)("a",{parentName:"p",href:"/guides/author-libraries"},"bundling a library")," for multiple ",(0,t.kt)("a",{parentName:"p",href:"/configuration/output/#outputlibrarytarget"},"targets")," such as AMD and CommonJS:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-js"},"module",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"exports ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"["),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    output",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      filename",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'./dist-amd.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n      libraryTarget",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'amd'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    name",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'amd'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    entry",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'./app.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    mode",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'production'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    output",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      filename",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'./dist-commonjs.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n      libraryTarget",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'commonjs'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    name",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'commonjs'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    entry",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'./app.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    mode",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'production'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{parentName:"aside",className:"tip__prefix"},"tip"),(0,t.kt)("p",{parentName:"aside"},"If you pass a name to ",(0,t.kt)("a",{parentName:"p",href:"/api/cli/#config-name"},(0,t.kt)("inlineCode",{parentName:"a"},"--config-name"))," flag, webpack will only build that specific configuration.")),(0,t.kt)("h3",{id:"parallelism"},"parallelism",(0,t.kt)("a",{parentName:"h3",href:"#parallelism","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("p",null,"In case you export multiple configurations, you can use ",(0,t.kt)("inlineCode",{parentName:"p"},"parallelism")," option on the configuration array to specify the maximum number of compilers that will compile in parallel."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Type: ",(0,t.kt)("inlineCode",{parentName:"li"},"number")),(0,t.kt)("li",{parentName:"ul"},"Available: 5.22.0+")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-javascript"},"module",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"exports ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"["),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token comment"},"//config-1"),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token comment"},"//config-2"),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\nmodule",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"exports",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"parallelism ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token number"},"1"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))))}o.isMDXComponent=!0}}]);