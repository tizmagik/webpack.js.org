(self.webpackChunk=self.webpackChunk||[]).push([[5684],{5684:function(a,e,n){"use strict";n.r(e),n.d(e,{default:function(){return p}}),n(7378);var t=n(5318);function s(){return(s=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t])}return a}).apply(this,arguments)}const o={};function p({components:a,...e}){return(0,t.kt)("wrapper",s({},o,e,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("hr",null),(0,t.kt)("p",null,"title: Web Workers\nsort: 21\ncontributors:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"chenxsan")),(0,t.kt)("hr",null),(0,t.kt)("p",null,"As of webpack 5, you can use ",(0,t.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers"},"Web Workers")," without ",(0,t.kt)("a",{parentName:"p",href:"https://github.com/webpack-contrib/worker-loader"},(0,t.kt)("inlineCode",{parentName:"a"},"worker-loader")),"."),(0,t.kt)("h2",{id:"syntax"},"Syntax",(0,t.kt)("a",{parentName:"h2",href:"#syntax","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-js"},(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"Worker"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"URL"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token string"},"'./worker.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"import"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"meta",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"url",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))),(0,t.kt)("p",null,"The syntax was chosen to allow running code without bundler, it is also available in native ECMAScript modules in the browser."),(0,t.kt)("h2",{id:"example"},"Example",(0,t.kt)("a",{parentName:"h2",href:"#example","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"src/index.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-js"},(0,t.kt)("span",{parentName:"code",className:"token keyword"},"const")," worker ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"Worker"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"URL"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token string"},"'./deep-thought.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"import"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"meta",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"url",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\nworker",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,t.kt)("span",{parentName:"code",className:"token function"},"postMessage"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  question",(0,t.kt)("span",{parentName:"code",className:"token operator"},":"),"\n    ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'The Answer to the Ultimate Question of Life, The Universe, and Everything.'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\nworker",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,t.kt)("span",{parentName:"code",className:"token function-variable function"},"onmessage")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token parameter"},(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"{")," data",(0,t.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"{")," answer ",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"}")," ",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"}")),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=>")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  console",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,t.kt)("span",{parentName:"code",className:"token function"},"log"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),"answer",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\n",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"src/deep-thought.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-js"},"self",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,t.kt)("span",{parentName:"code",className:"token function-variable function"},"onmessage")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token parameter"},(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"{")," data",(0,t.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"{")," question ",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"}")," ",(0,t.kt)("span",{parentName:"span",className:"token punctuation"},"}")),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,t.kt)("span",{parentName:"code",className:"token operator"},"=>")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  self",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,t.kt)("span",{parentName:"code",className:"token function"},"postMessage"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    answer",(0,t.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,t.kt)("span",{parentName:"code",className:"token number"},"42"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n  ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\n",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))),(0,t.kt)("h2",{id:"nodejs"},"Node.js",(0,t.kt)("a",{parentName:"h2",href:"#nodejs","aria-hidden":"true",tabIndex:-1},(0,t.kt)("span",{parentName:"a",className:"header-link"}))),(0,t.kt)("p",null,"Similar syntax is supported in Node.js (>= 12.17.0):"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"hljs language-js"},(0,t.kt)("span",{parentName:"code",className:"token keyword"},"import")," ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"{")," Worker ",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"from")," ",(0,t.kt)("span",{parentName:"code",className:"token string"},"'worker_threads'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"Worker"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,t.kt)("span",{parentName:"code",className:"token class-name"},"URL"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,t.kt)("span",{parentName:"code",className:"token string"},"'./worker.js'"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,t.kt)("span",{parentName:"code",className:"token keyword"},"import"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"meta",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},"."),"url",(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,t.kt)("span",{parentName:"code",className:"token punctuation"},";"))),(0,t.kt)("p",null,"Note that this is only available in ESM. CommonJS is not supported by neither webpack nor Node.js."))}p.isMDXComponent=!0}}]);